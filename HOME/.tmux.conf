# ==============================================================================
# tmux Configuration - Emacs Compatible
# ==============================================================================
# C-x prefix (Emacs style)
#
# ┌──────────┬───────────────────┬──────────────────────────┐
# │ Key      │ Action            │ Description              │
# ├──────────┼───────────────────┼──────────────────────────┤
# │ C-x 2    │ split-window -v   │ Horizontal split (below) │
# │ C-x 3    │ split-window -h   │ Vertical split (right)   │
# │ C-x 0    │ kill-pane         │ Close current pane       │
# │ C-x 1    │ resize-pane -Z    │ Zoom toggle              │
# │ C-x o    │ select-pane next  │ Next pane                │
# │ C-x ←↑↓→ │ select-pane       │ Navigate by direction    │
# │ C-x n    │ select-pane prev  │ Previous pane            │
# │ C-x d    │ detach            │ Detach session           │
# │ C-x 4    │ select-layout -E  │ Balance panes equally    │
# │ C-x 6    │ display-popup     │ Floating shell (center)  │
# │ C-x C-x  │ send-prefix       │ Send C-x to app         │
# └──────────┴───────────────────┴──────────────────────────┘

# ------------------------------------------------------------------------------
# Prefix
# ------------------------------------------------------------------------------

set -g prefix C-x
unbind C-b
bind C-x send-prefix

# ------------------------------------------------------------------------------
# Pane Operations
# ------------------------------------------------------------------------------

# Split (keep current path)
bind 2 split-window -v -c "#{pane_current_path}"
bind 3 split-window -h -c "#{pane_current_path}"
bind 0 kill-pane
bind 1 resize-pane -Z

# Navigation
bind o select-pane -t :.+
bind n select-pane -t :.-
bind Left select-pane -L
bind Down select-pane -D
bind Up select-pane -U
bind Right select-pane -R
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# ------------------------------------------------------------------------------
# Floating Popup
# ------------------------------------------------------------------------------

bind 4 select-layout -E
bind 6 display-popup -E -w 80% -h 80% -d "#{pane_current_path}"

# ------------------------------------------------------------------------------
# Session
# ------------------------------------------------------------------------------

bind d detach-client

# Cancel (Emacs C-g)
bind C-g display-message "Cancelled"

# ------------------------------------------------------------------------------
# Terminal
# ------------------------------------------------------------------------------

set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",ghostty:Tc"
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'
set -as terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'
set -sg escape-time 10
set -g mouse on
set -s set-clipboard on
bind -T copy-mode MouseDragEnd1Pane send-keys -X copy-selection-and-cancel
bind -T copy-mode M-n send-keys -X page-down
bind -T copy-mode M-p send-keys -X page-up
set -g history-limit 50000
set -g focus-events on

# ------------------------------------------------------------------------------
# Window / Pane
# ------------------------------------------------------------------------------

set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g allow-rename on
set -g set-titles on
setw -g automatic-rename on
set -g pane-border-lines single
set -g pane-border-status top
set -g pane-border-format " #{pane_current_command}: #{b:pane_current_path} "

# ------------------------------------------------------------------------------
# Status Bar (minimal)
# ------------------------------------------------------------------------------

set -g status off
